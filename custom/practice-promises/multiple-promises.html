<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <title>My test page</title>
  </head>
  <body>
    <p>This is my page</p>
    <script>
      function fetchAndDecode(url) {
        return fetch(url).then(response => {
          if(!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          } else {
            const type = response.headers.get("content-type");
            if(type === 'image/jpeg') {
              return response.blob();
            } else if(type.startsWith("text/")) {
              return response.text();
            }
          }
        })
        .catch(e => {
          console.log(`There has been a problem with your fetch operation for resource "${url}": ` + e.message);
        });
      }

    let items = [
      'coffee.jpg',
      'tea.jpg',
      'description.txt',
    ];
    let promises = [];
    for (item of items) {
      promises.push(fetchAndDecode(item));
    }

    Promise.all(promises).then(values => {
      console.log(values);
      for (value of values) {
        if (value instanceof Blob) {
          let objectURL = URL.createObjectURL(value);
          let image = document.createElement('img');
          image.src = objectURL;
          document.body.appendChild(image);
        } else if (typeof value === 'string') {
          text = value;
          let paragraph = document.createElement('p');
          paragraph.textContent = text;
          document.body.appendChild(paragraph);
        }
      }
    });
    </script>
  </body>
</html>